Namespace(cuda=1, dev_data='../release/dev', dev_ref_file='../release/dev/dev_ref.csv', epochs=100, kernel_size=7, learning_rate=5e-06, log_name='conv_sampler.log', model_name='conv_sampler.pth', pretrained_model='bert-base-multilingual-cased', ratio=3.0, round=2000, train='conv', train_data='../release/train', use_sampler=True)
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-multilingual-cased-config.json from cache at /home/robert1003/.cache/torch/transformers/45629519f3117b89d89fd9c740073d8e4c1f0a70f9842476185100a8afe715d1.65df3cef028a0c91a7b059e4c404a975ebe6843c71267b67019c0e9cfa8a88f0
Model config BertConfig {
  "_num_labels": 2,
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "bad_words_ids": null,
  "bos_token_id": null,
  "decoder_start_token_id": null,
  "directionality": "bidi",
  "do_sample": false,
  "early_stopping": false,
  "eos_token_id": null,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "is_decoder": false,
  "is_encoder_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "max_position_embeddings": 512,
  "min_length": 0,
  "model_type": "bert",
  "no_repeat_ngram_size": 0,
  "num_attention_heads": 12,
  "num_beams": 1,
  "num_hidden_layers": 12,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "prefix": null,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "task_specific_params": null,
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "type_vocab_size": 2,
  "use_bfloat16": false,
  "vocab_size": 119547
}

loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-multilingual-cased-vocab.txt from cache at /home/robert1003/.cache/torch/transformers/96435fa287fbf7e469185f1062386e05a075cadbf6838b74da22bf64b080bc32.99bcd55fc66f4f3360bc49ba472b940b8dcf223ea6a345deb969d607ca900729
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-multilingual-cased-config.json from cache at /home/robert1003/.cache/torch/transformers/45629519f3117b89d89fd9c740073d8e4c1f0a70f9842476185100a8afe715d1.65df3cef028a0c91a7b059e4c404a975ebe6843c71267b67019c0e9cfa8a88f0
Model config BertConfig {
  "_num_labels": 2,
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "bad_words_ids": null,
  "bos_token_id": null,
  "decoder_start_token_id": null,
  "directionality": "bidi",
  "do_sample": false,
  "early_stopping": false,
  "eos_token_id": null,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "is_decoder": false,
  "is_encoder_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "max_position_embeddings": 512,
  "min_length": 0,
  "model_type": "bert",
  "no_repeat_ngram_size": 0,
  "num_attention_heads": 12,
  "num_beams": 1,
  "num_hidden_layers": 12,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "prefix": null,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "task_specific_params": null,
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "type_vocab_size": 2,
  "use_bfloat16": false,
  "vocab_size": 119547
}

loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-multilingual-cased-pytorch_model.bin from cache at /home/robert1003/.cache/torch/transformers/5b5b80054cd2c95a946a8e0ce0b93f56326dff9fbda6a6c3e02de3c91c918342.7131dcb754361639a7d5526985f880879c9bfd144b65a0bf50590bddb7de9059
Epoch 1/100: training loss = 1.02372, dev loss = 0.33626, dev f1 score = 0.91873, Time 8m 39s (- 857m 9s)
Update best f1: 0.00000 -> 0.91873, saving model to conv_sampler.pth
Epoch 2/100: training loss = 0.43225, dev loss = 0.26615, dev f1 score = 0.92465, Time 17m 44s (- 869m 29s)
Update best f1: 0.91873 -> 0.92465, saving model to conv_sampler.pth
Epoch 3/100: training loss = 0.37672, dev loss = 0.24821, dev f1 score = 0.92747, Time 26m 57s (- 871m 47s)
Update best f1: 0.92465 -> 0.92747, saving model to conv_sampler.pth
Epoch 4/100: training loss = 0.31355, dev loss = 0.23656, dev f1 score = 0.92324, Time 36m 8s (- 867m 20s)
Epoch 5/100: training loss = 0.29166, dev loss = 0.26493, dev f1 score = 0.92305, Time 44m 51s (- 852m 19s)
Epoch 6/100: training loss = 0.27128, dev loss = 0.24265, dev f1 score = 0.92377, Time 53m 44s (- 842m 3s)
Epoch 7/100: training loss = 0.25772, dev loss = 0.22322, dev f1 score = 0.92773, Time 62m 28s (- 829m 58s)
Update best f1: 0.92747 -> 0.92773, saving model to conv_sampler.pth
Epoch 8/100: training loss = 0.25347, dev loss = 0.23898, dev f1 score = 0.92437, Time 71m 34s (- 823m 10s)
Epoch 9/100: training loss = 0.24287, dev loss = 0.23092, dev f1 score = 0.92933, Time 80m 18s (- 811m 57s)
Update best f1: 0.92773 -> 0.92933, saving model to conv_sampler.pth
Epoch 10/100: training loss = 0.23136, dev loss = 0.23025, dev f1 score = 0.92666, Time 89m 23s (- 804m 34s)
Epoch 11/100: training loss = 0.22807, dev loss = 0.28637, dev f1 score = 0.92516, Time 98m 6s (- 793m 45s)
Epoch 12/100: training loss = 0.22567, dev loss = 0.24807, dev f1 score = 0.92490, Time 106m 50s (- 783m 29s)
Epoch 13/100: training loss = 0.22299, dev loss = 0.24009, dev f1 score = 0.92678, Time 115m 35s (- 773m 35s)
Epoch 14/100: training loss = 0.20673, dev loss = 0.25307, dev f1 score = 0.93026, Time 124m 20s (- 763m 48s)
Update best f1: 0.92933 -> 0.93026, saving model to conv_sampler.pth
Epoch 15/100: training loss = 0.21258, dev loss = 0.28117, dev f1 score = 0.92345, Time 133m 27s (- 756m 16s)
Epoch 16/100: training loss = 0.20727, dev loss = 0.26818, dev f1 score = 0.92560, Time 142m 11s (- 746m 31s)
Epoch 17/100: training loss = 0.20425, dev loss = 0.31571, dev f1 score = 0.92336, Time 150m 55s (- 736m 49s)
Epoch 18/100: training loss = 0.21081, dev loss = 0.26262, dev f1 score = 0.92421, Time 159m 39s (- 727m 17s)
Epoch 19/100: training loss = 0.20683, dev loss = 0.27418, dev f1 score = 0.92643, Time 168m 22s (- 717m 49s)
Epoch 20/100: training loss = 0.19759, dev loss = 0.25992, dev f1 score = 0.92378, Time 177m 6s (- 708m 24s)
Epoch 21/100: training loss = 0.20136, dev loss = 0.28019, dev f1 score = 0.92836, Time 185m 49s (- 699m 2s)
Epoch 22/100: training loss = 0.20339, dev loss = 0.28888, dev f1 score = 0.92927, Time 194m 32s (- 689m 43s)
Epoch 23/100: training loss = 0.19672, dev loss = 0.26768, dev f1 score = 0.92496, Time 203m 15s (- 680m 27s)
Epoch 24/100: training loss = 0.18724, dev loss = 0.25325, dev f1 score = 0.92629, Time 211m 58s (- 671m 15s)
Epoch 25/100: training loss = 0.19655, dev loss = 0.28831, dev f1 score = 0.92533, Time 220m 42s (- 662m 6s)
Epoch 26/100: training loss = 0.18994, dev loss = 0.30479, dev f1 score = 0.92947, Time 229m 25s (- 652m 58s)
Epoch 27/100: training loss = 0.19809, dev loss = 0.28854, dev f1 score = 0.92803, Time 238m 8s (- 643m 51s)
Epoch 28/100: training loss = 0.20334, dev loss = 0.29380, dev f1 score = 0.92540, Time 246m 51s (- 634m 47s)
Epoch 29/100: training loss = 0.19659, dev loss = 0.28326, dev f1 score = 0.92698, Time 255m 35s (- 625m 44s)
Epoch 30/100: training loss = 0.18847, dev loss = 0.34151, dev f1 score = 0.92979, Time 264m 17s (- 616m 41s)
Epoch 31/100: training loss = 0.18735, dev loss = 0.29779, dev f1 score = 0.92852, Time 273m 0s (- 607m 39s)
Epoch 32/100: training loss = 0.18198, dev loss = 0.28318, dev f1 score = 0.92518, Time 281m 42s (- 598m 37s)
Epoch 33/100: training loss = 0.18683, dev loss = 0.34164, dev f1 score = 0.92835, Time 290m 24s (- 589m 37s)
Epoch 34/100: training loss = 0.19123, dev loss = 0.29809, dev f1 score = 0.92778, Time 299m 7s (- 580m 38s)
Epoch 35/100: training loss = 0.18500, dev loss = 0.31168, dev f1 score = 0.93003, Time 307m 49s (- 571m 40s)
Epoch 36/100: training loss = 0.18407, dev loss = 0.27885, dev f1 score = 0.92562, Time 316m 31s (- 562m 43s)
Epoch 37/100: training loss = 0.19254, dev loss = 0.27347, dev f1 score = 0.92568, Time 325m 15s (- 553m 49s)
Epoch 38/100: training loss = 0.19552, dev loss = 0.29463, dev f1 score = 0.92826, Time 333m 58s (- 544m 54s)
Epoch 39/100: training loss = 0.18455, dev loss = 0.29615, dev f1 score = 0.92650, Time 342m 41s (- 536m 0s)
Epoch 40/100: training loss = 0.18150, dev loss = 0.30360, dev f1 score = 0.92525, Time 351m 24s (- 527m 6s)
Epoch 41/100: training loss = 0.18551, dev loss = 0.35518, dev f1 score = 0.92370, Time 360m 6s (- 518m 12s)
Epoch 42/100: training loss = 0.18978, dev loss = 0.29918, dev f1 score = 0.92413, Time 368m 49s (- 509m 19s)
Epoch 43/100: training loss = 0.18469, dev loss = 0.32195, dev f1 score = 0.92772, Time 377m 31s (- 500m 26s)
Epoch 44/100: training loss = 0.18736, dev loss = 0.30934, dev f1 score = 0.92831, Time 386m 15s (- 491m 36s)
Epoch 45/100: training loss = 0.18198, dev loss = 0.29873, dev f1 score = 0.92787, Time 395m 1s (- 482m 48s)
Epoch 46/100: training loss = 0.18498, dev loss = 0.28853, dev f1 score = 0.93045, Time 403m 45s (- 473m 58s)
Update best f1: 0.93026 -> 0.93045, saving model to conv_sampler.pth
Epoch 47/100: training loss = 0.18128, dev loss = 0.29846, dev f1 score = 0.92512, Time 412m 54s (- 465m 37s)
Epoch 48/100: training loss = 0.17245, dev loss = 0.33641, dev f1 score = 0.92980, Time 421m 37s (- 456m 45s)
Epoch 49/100: training loss = 0.17754, dev loss = 0.31325, dev f1 score = 0.92625, Time 430m 20s (- 447m 54s)
Epoch 50/100: training loss = 0.19401, dev loss = 0.30764, dev f1 score = 0.92939, Time 439m 4s (- 439m 4s)
Epoch 51/100: training loss = 0.18130, dev loss = 0.31210, dev f1 score = 0.92920, Time 447m 47s (- 430m 13s)
Epoch 52/100: training loss = 0.18290, dev loss = 0.32272, dev f1 score = 0.92658, Time 456m 30s (- 421m 23s)
Epoch 53/100: training loss = 0.18518, dev loss = 0.31228, dev f1 score = 0.92869, Time 465m 13s (- 412m 33s)
Epoch 54/100: training loss = 0.18244, dev loss = 0.34439, dev f1 score = 0.92848, Time 473m 55s (- 403m 43s)
Epoch 55/100: training loss = 0.18686, dev loss = 0.32849, dev f1 score = 0.92784, Time 482m 39s (- 394m 54s)
Epoch 56/100: training loss = 0.18058, dev loss = 0.31821, dev f1 score = 0.92657, Time 491m 23s (- 386m 5s)
Epoch 57/100: training loss = 0.17751, dev loss = 0.31844, dev f1 score = 0.92652, Time 500m 7s (- 377m 17s)
Epoch 58/100: training loss = 0.17121, dev loss = 0.33067, dev f1 score = 0.92856, Time 508m 50s (- 368m 28s)
Epoch 59/100: training loss = 0.18064, dev loss = 0.33617, dev f1 score = 0.92742, Time 517m 33s (- 359m 39s)
Epoch 60/100: training loss = 0.17574, dev loss = 0.36188, dev f1 score = 0.93082, Time 526m 18s (- 350m 52s)
Update best f1: 0.93045 -> 0.93082, saving model to conv_sampler.pth
Epoch 61/100: training loss = 0.18037, dev loss = 0.32765, dev f1 score = 0.93106, Time 535m 39s (- 342m 28s)
Update best f1: 0.93082 -> 0.93106, saving model to conv_sampler.pth
Epoch 62/100: training loss = 0.19597, dev loss = 0.31334, dev f1 score = 0.92776, Time 544m 49s (- 333m 55s)
Epoch 63/100: training loss = 0.17079, dev loss = 0.33811, dev f1 score = 0.92702, Time 553m 36s (- 325m 8s)
Epoch 64/100: training loss = 0.17507, dev loss = 0.34664, dev f1 score = 0.92367, Time 562m 22s (- 316m 19s)
Epoch 65/100: training loss = 0.18275, dev loss = 0.32282, dev f1 score = 0.93060, Time 571m 1s (- 307m 28s)
Epoch 66/100: training loss = 0.17827, dev loss = 0.34434, dev f1 score = 0.92895, Time 579m 41s (- 298m 37s)
Epoch 67/100: training loss = 0.17270, dev loss = 0.34291, dev f1 score = 0.92583, Time 588m 25s (- 289m 49s)
Epoch 68/100: training loss = 0.18495, dev loss = 0.29876, dev f1 score = 0.92472, Time 597m 7s (- 281m 0s)
Epoch 69/100: training loss = 0.18290, dev loss = 0.30457, dev f1 score = 0.92427, Time 605m 47s (- 272m 9s)
Epoch 70/100: training loss = 0.18152, dev loss = 0.31420, dev f1 score = 0.92946, Time 614m 28s (- 263m 20s)
Epoch 71/100: training loss = 0.17315, dev loss = 0.31843, dev f1 score = 0.92672, Time 623m 7s (- 254m 30s)
Epoch 72/100: training loss = 0.17535, dev loss = 0.36832, dev f1 score = 0.92782, Time 631m 54s (- 245m 44s)
Epoch 73/100: training loss = 0.18390, dev loss = 0.31109, dev f1 score = 0.92806, Time 640m 33s (- 236m 55s)
Epoch 74/100: training loss = 0.17848, dev loss = 0.31398, dev f1 score = 0.92847, Time 649m 12s (- 228m 6s)
Epoch 75/100: training loss = 0.17141, dev loss = 0.33019, dev f1 score = 0.92375, Time 657m 51s (- 219m 17s)
Epoch 76/100: training loss = 0.17982, dev loss = 0.32410, dev f1 score = 0.92603, Time 666m 31s (- 210m 28s)
Epoch 77/100: training loss = 0.17734, dev loss = 0.31634, dev f1 score = 0.92700, Time 675m 11s (- 201m 40s)
Epoch 78/100: training loss = 0.18637, dev loss = 0.31611, dev f1 score = 0.92929, Time 683m 51s (- 192m 52s)
Epoch 79/100: training loss = 0.17248, dev loss = 0.33198, dev f1 score = 0.93012, Time 692m 30s (- 184m 5s)
Epoch 80/100: training loss = 0.17697, dev loss = 0.30872, dev f1 score = 0.92853, Time 701m 10s (- 175m 17s)
Epoch 81/100: training loss = 0.18671, dev loss = 0.31563, dev f1 score = 0.92646, Time 709m 49s (- 166m 30s)
Epoch 82/100: training loss = 0.17535, dev loss = 0.31926, dev f1 score = 0.92676, Time 718m 29s (- 157m 42s)
Epoch 83/100: training loss = 0.17605, dev loss = 0.32638, dev f1 score = 0.92430, Time 727m 9s (- 148m 56s)
Epoch 84/100: training loss = 0.17951, dev loss = 0.33500, dev f1 score = 0.92491, Time 735m 49s (- 140m 9s)
Epoch 85/100: training loss = 0.17813, dev loss = 0.34171, dev f1 score = 0.92830, Time 744m 29s (- 131m 22s)
Epoch 86/100: training loss = 0.17649, dev loss = 0.34358, dev f1 score = 0.92537, Time 753m 8s (- 122m 36s)
Epoch 87/100: training loss = 0.17950, dev loss = 0.31795, dev f1 score = 0.93124, Time 761m 47s (- 113m 49s)
Update best f1: 0.93106 -> 0.93124, saving model to conv_sampler.pth
Epoch 88/100: training loss = 0.17249, dev loss = 0.33919, dev f1 score = 0.92821, Time 771m 3s (- 105m 8s)
Epoch 89/100: training loss = 0.17127, dev loss = 0.31192, dev f1 score = 0.92624, Time 779m 43s (- 96m 22s)
Epoch 90/100: training loss = 0.17122, dev loss = 0.33955, dev f1 score = 0.92731, Time 788m 23s (- 87m 35s)
Epoch 91/100: training loss = 0.17280, dev loss = 0.29498, dev f1 score = 0.93042, Time 797m 5s (- 78m 49s)
Epoch 92/100: training loss = 0.17810, dev loss = 0.33208, dev f1 score = 0.92857, Time 805m 47s (- 70m 4s)
Epoch 93/100: training loss = 0.17660, dev loss = 0.31603, dev f1 score = 0.92791, Time 814m 27s (- 61m 18s)
Epoch 94/100: training loss = 0.17928, dev loss = 0.33400, dev f1 score = 0.92786, Time 823m 7s (- 52m 32s)
Epoch 95/100: training loss = 0.17109, dev loss = 0.33673, dev f1 score = 0.92620, Time 831m 47s (- 43m 46s)
Epoch 96/100: training loss = 0.17689, dev loss = 0.37304, dev f1 score = 0.92331, Time 840m 29s (- 35m 1s)
Epoch 97/100: training loss = 0.17562, dev loss = 0.31127, dev f1 score = 0.92466, Time 849m 10s (- 26m 15s)
Epoch 98/100: training loss = 0.18596, dev loss = 0.33211, dev f1 score = 0.92737, Time 857m 51s (- 17m 30s)
Epoch 99/100: training loss = 0.17881, dev loss = 0.35645, dev f1 score = 0.92639, Time 866m 31s (- 8m 45s)
Epoch 100/100: training loss = 0.17932, dev loss = 0.32086, dev f1 score = 0.92853, Time 875m 11s (- 0m 0s)
Best dev f1: 0.93124
