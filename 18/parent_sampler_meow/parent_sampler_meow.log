Namespace(batch_size=4, cuda=1, dev_data='../release/dev', dev_ref_file='../release/dev/dev_ref.csv', epochs=50, hw2_QA_bert='../bert.pth', kernel_size=7, learning_rate=5e-06, log_name='parent_sampler_higher_ratio.log', merge_type=0, model_name='parent_sampler_higher_ratio.pth', overlap_k=0, pretrained_model='bert-base-multilingual-cased', ratio=4.0, round=2000, train='conv', train_data='../release/train', use_sampler=True)
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-multilingual-cased-config.json from cache at /tmp3/b07902047/.cache/45629519f3117b89d89fd9c740073d8e4c1f0a70f9842476185100a8afe715d1.65df3cef028a0c91a7b059e4c404a975ebe6843c71267b67019c0e9cfa8a88f0
Model config BertConfig {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "directionality": "bidi",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "type_vocab_size": 2,
  "vocab_size": 119547
}

loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-multilingual-cased-vocab.txt from cache at /tmp3/b07902047/.cache/96435fa287fbf7e469185f1062386e05a075cadbf6838b74da22bf64b080bc32.99bcd55fc66f4f3360bc49ba472b940b8dcf223ea6a345deb969d607ca900729
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-multilingual-cased-config.json from cache at /tmp3/b07902047/.cache/45629519f3117b89d89fd9c740073d8e4c1f0a70f9842476185100a8afe715d1.65df3cef028a0c91a7b059e4c404a975ebe6843c71267b67019c0e9cfa8a88f0
Model config BertConfig {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "directionality": "bidi",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "type_vocab_size": 2,
  "vocab_size": 119547
}

loading weights file https://cdn.huggingface.co/bert-base-multilingual-cased-pytorch_model.bin from cache at /tmp3/b07902047/.cache/3d1d2b2daef1e2b3ddc2180ddaae8b7a37d5f279babce0068361f71cd548f615.7131dcb754361639a7d5526985f880879c9bfd144b65a0bf50590bddb7de9059
Epoch 1/50: training loss = 0.34855, dev loss = 0.06488, dev f1 score = 0.94672, Time 10m 14s (- 501m 58s)
Update best f1: 0.00000 -> 0.94672, thres 0.20, saving model to f1_parent_sampler_higher_ratio.pth
Update best loss: 1000000000.00000 -> 0.06488, saving model to loss_parent_sampler_higher_ratio.pth
Epoch 2/50: training loss = 0.12025, dev loss = 0.04932, dev f1 score = 0.95328, Time 20m 38s (- 495m 33s)
Update best f1: 0.94672 -> 0.95328, thres 0.70, saving model to f1_parent_sampler_higher_ratio.pth
Update best loss: 0.06488 -> 0.04932, saving model to loss_parent_sampler_higher_ratio.pth
Epoch 3/50: training loss = 0.08431, dev loss = 0.04896, dev f1 score = 0.95721, Time 31m 4s (- 486m 43s)
Update best f1: 0.95328 -> 0.95721, thres 0.20, saving model to f1_parent_sampler_higher_ratio.pth
Update best loss: 0.04932 -> 0.04896, saving model to loss_parent_sampler_higher_ratio.pth
Epoch 4/50: training loss = 0.07026, dev loss = 0.05410, dev f1 score = 0.95889, Time 41m 32s (- 477m 41s)
Update best f1: 0.95721 -> 0.95889, thres 0.10, saving model to f1_parent_sampler_higher_ratio.pth
Epoch 5/50: training loss = 0.06679, dev loss = 0.05941, dev f1 score = 0.95468, Time 51m 37s (- 464m 36s)
Epoch 6/50: training loss = 0.05034, dev loss = 0.04669, dev f1 score = 0.95770, Time 61m 32s (- 451m 21s)
Update best loss: 0.04896 -> 0.04669, saving model to loss_parent_sampler_higher_ratio.pth
Epoch 7/50: training loss = 0.05384, dev loss = 0.04119, dev f1 score = 0.96073, Time 71m 30s (- 439m 18s)
Update best f1: 0.95889 -> 0.96073, thres 0.50, saving model to f1_parent_sampler_higher_ratio.pth
Update best loss: 0.04669 -> 0.04119, saving model to loss_parent_sampler_higher_ratio.pth
Epoch 8/50: training loss = 0.05492, dev loss = 0.04607, dev f1 score = 0.95730, Time 81m 30s (- 427m 57s)
Epoch 9/50: training loss = 0.05103, dev loss = 0.04622, dev f1 score = 0.95814, Time 91m 25s (- 416m 27s)
Epoch 10/50: training loss = 0.04655, dev loss = 0.04385, dev f1 score = 0.96060, Time 101m 21s (- 405m 25s)
Epoch 11/50: training loss = 0.04488, dev loss = 0.04332, dev f1 score = 0.95748, Time 112m 23s (- 398m 28s)
Epoch 12/50: training loss = 0.04433, dev loss = 0.04194, dev f1 score = 0.96177, Time 123m 40s (- 391m 38s)
Update best f1: 0.96073 -> 0.96177, thres 0.30, saving model to f1_parent_sampler_higher_ratio.pth
Epoch 13/50: training loss = 0.04453, dev loss = 0.04605, dev f1 score = 0.96040, Time 135m 2s (- 384m 21s)
Epoch 14/50: training loss = 0.03409, dev loss = 0.05536, dev f1 score = 0.96063, Time 146m 21s (- 376m 20s)
Epoch 15/50: training loss = 0.04552, dev loss = 0.04319, dev f1 score = 0.96304, Time 157m 28s (- 367m 26s)
Update best f1: 0.96177 -> 0.96304, thres 0.20, saving model to f1_parent_sampler_higher_ratio.pth
Epoch 16/50: training loss = 0.03875, dev loss = 0.04679, dev f1 score = 0.95925, Time 168m 42s (- 358m 29s)
Epoch 17/50: training loss = 0.04193, dev loss = 0.04990, dev f1 score = 0.95840, Time 179m 51s (- 349m 8s)
Epoch 18/50: training loss = 0.04079, dev loss = 0.04676, dev f1 score = 0.95894, Time 190m 59s (- 339m 33s)
Epoch 19/50: training loss = 0.03501, dev loss = 0.04834, dev f1 score = 0.96063, Time 202m 5s (- 329m 44s)
Epoch 20/50: training loss = 0.02858, dev loss = 0.05504, dev f1 score = 0.95594, Time 213m 30s (- 320m 16s)
Epoch 21/50: training loss = 0.03263, dev loss = 0.05075, dev f1 score = 0.95980, Time 225m 0s (- 310m 43s)
Epoch 22/50: training loss = 0.03562, dev loss = 0.05381, dev f1 score = 0.95897, Time 236m 29s (- 300m 59s)
Epoch 23/50: training loss = 0.03190, dev loss = 0.04740, dev f1 score = 0.96232, Time 248m 8s (- 291m 17s)
Epoch 24/50: training loss = 0.03135, dev loss = 0.04800, dev f1 score = 0.96195, Time 259m 37s (- 281m 16s)
Epoch 25/50: training loss = 0.03068, dev loss = 0.04417, dev f1 score = 0.96169, Time 270m 8s (- 270m 8s)
Epoch 26/50: training loss = 0.03240, dev loss = 0.05030, dev f1 score = 0.96268, Time 280m 20s (- 258m 46s)
Epoch 27/50: training loss = 0.02711, dev loss = 0.04803, dev f1 score = 0.96053, Time 291m 9s (- 248m 1s)
Epoch 28/50: training loss = 0.03054, dev loss = 0.04948, dev f1 score = 0.95824, Time 302m 34s (- 237m 43s)
Epoch 29/50: training loss = 0.03302, dev loss = 0.04697, dev f1 score = 0.96205, Time 313m 53s (- 227m 18s)
Epoch 30/50: training loss = 0.03210, dev loss = 0.04401, dev f1 score = 0.96074, Time 325m 9s (- 216m 46s)
Epoch 31/50: training loss = 0.02732, dev loss = 0.05449, dev f1 score = 0.95984, Time 336m 38s (- 206m 19s)
Epoch 32/50: training loss = 0.03062, dev loss = 0.04729, dev f1 score = 0.96000, Time 350m 19s (- 197m 3s)
Epoch 33/50: training loss = 0.02572, dev loss = 0.05355, dev f1 score = 0.96058, Time 361m 30s (- 186m 14s)
Epoch 34/50: training loss = 0.02756, dev loss = 0.05557, dev f1 score = 0.96075, Time 376m 15s (- 177m 3s)
Epoch 35/50: training loss = 0.03060, dev loss = 0.04839, dev f1 score = 0.96370, Time 387m 16s (- 165m 58s)
Update best f1: 0.96304 -> 0.96370, thres 0.60, saving model to f1_parent_sampler_higher_ratio.pth
Epoch 36/50: training loss = 0.02796, dev loss = 0.04755, dev f1 score = 0.96271, Time 398m 45s (- 155m 4s)
Epoch 37/50: training loss = 0.02802, dev loss = 0.04884, dev f1 score = 0.96140, Time 410m 0s (- 144m 3s)
Epoch 38/50: training loss = 0.02563, dev loss = 0.05355, dev f1 score = 0.96255, Time 421m 28s (- 133m 5s)
Epoch 39/50: training loss = 0.02879, dev loss = 0.05189, dev f1 score = 0.96135, Time 432m 49s (- 122m 4s)
Epoch 40/50: training loss = 0.02383, dev loss = 0.05777, dev f1 score = 0.96218, Time 445m 6s (- 111m 16s)
Epoch 41/50: training loss = 0.02587, dev loss = 0.05549, dev f1 score = 0.95884, Time 456m 32s (- 100m 12s)
Epoch 42/50: training loss = 0.02780, dev loss = 0.05738, dev f1 score = 0.96125, Time 466m 54s (- 88m 56s)
Epoch 43/50: training loss = 0.03196, dev loss = 0.04890, dev f1 score = 0.96069, Time 476m 49s (- 77m 37s)
Epoch 44/50: training loss = 0.02702, dev loss = 0.05380, dev f1 score = 0.95904, Time 486m 45s (- 66m 22s)
Epoch 45/50: training loss = 0.02053, dev loss = 0.06041, dev f1 score = 0.96154, Time 496m 40s (- 55m 11s)
Epoch 46/50: training loss = 0.02542, dev loss = 0.05098, dev f1 score = 0.96037, Time 506m 35s (- 44m 3s)
Epoch 47/50: training loss = 0.02066, dev loss = 0.05699, dev f1 score = 0.96116, Time 516m 31s (- 32m 58s)
Epoch 48/50: training loss = 0.02383, dev loss = 0.06025, dev f1 score = 0.96043, Time 526m 27s (- 21m 56s)
