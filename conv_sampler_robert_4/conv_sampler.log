Namespace(cuda=1, dev_data='../release/dev', dev_ref_file='../release/dev/dev_ref.csv', epochs=100, kernel_size=7, learning_rate=5e-06, log_name='conv_sampler.log', model_name='conv_sampler.pth', pretrained_model='bert-base-multilingual-cased', ratio=5.0, round=2000, train='conv', train_data='../release/train', use_sampler=True)
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-multilingual-cased-config.json from cache at /home/robert1003/.cache/torch/transformers/45629519f3117b89d89fd9c740073d8e4c1f0a70f9842476185100a8afe715d1.65df3cef028a0c91a7b059e4c404a975ebe6843c71267b67019c0e9cfa8a88f0
Model config BertConfig {
  "_num_labels": 2,
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "bad_words_ids": null,
  "bos_token_id": null,
  "decoder_start_token_id": null,
  "directionality": "bidi",
  "do_sample": false,
  "early_stopping": false,
  "eos_token_id": null,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "is_decoder": false,
  "is_encoder_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "max_position_embeddings": 512,
  "min_length": 0,
  "model_type": "bert",
  "no_repeat_ngram_size": 0,
  "num_attention_heads": 12,
  "num_beams": 1,
  "num_hidden_layers": 12,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "prefix": null,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "task_specific_params": null,
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "type_vocab_size": 2,
  "use_bfloat16": false,
  "vocab_size": 119547
}

loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-multilingual-cased-vocab.txt from cache at /home/robert1003/.cache/torch/transformers/96435fa287fbf7e469185f1062386e05a075cadbf6838b74da22bf64b080bc32.99bcd55fc66f4f3360bc49ba472b940b8dcf223ea6a345deb969d607ca900729
loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-multilingual-cased-config.json from cache at /home/robert1003/.cache/torch/transformers/45629519f3117b89d89fd9c740073d8e4c1f0a70f9842476185100a8afe715d1.65df3cef028a0c91a7b059e4c404a975ebe6843c71267b67019c0e9cfa8a88f0
Model config BertConfig {
  "_num_labels": 2,
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "bad_words_ids": null,
  "bos_token_id": null,
  "decoder_start_token_id": null,
  "directionality": "bidi",
  "do_sample": false,
  "early_stopping": false,
  "eos_token_id": null,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "is_decoder": false,
  "is_encoder_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-12,
  "length_penalty": 1.0,
  "max_length": 20,
  "max_position_embeddings": 512,
  "min_length": 0,
  "model_type": "bert",
  "no_repeat_ngram_size": 0,
  "num_attention_heads": 12,
  "num_beams": 1,
  "num_hidden_layers": 12,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 0,
  "pooler_fc_size": 768,
  "pooler_num_attention_heads": 12,
  "pooler_num_fc_layers": 3,
  "pooler_size_per_head": 128,
  "pooler_type": "first_token_transform",
  "prefix": null,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "task_specific_params": null,
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "type_vocab_size": 2,
  "use_bfloat16": false,
  "vocab_size": 119547
}

loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-multilingual-cased-pytorch_model.bin from cache at /home/robert1003/.cache/torch/transformers/5b5b80054cd2c95a946a8e0ce0b93f56326dff9fbda6a6c3e02de3c91c918342.7131dcb754361639a7d5526985f880879c9bfd144b65a0bf50590bddb7de9059
Epoch 1/100: training loss = 1.15626, dev loss = 0.36977, dev f1 score = 0.91979, Time 9m 0s (- 892m 24s)
Update best f1: 0.00000 -> 0.91979, saving model to conv_sampler.pth
Epoch 2/100: training loss = 0.51150, dev loss = 0.38568, dev f1 score = 0.91855, Time 18m 28s (- 904m 59s)
Epoch 3/100: training loss = 0.42376, dev loss = 0.35476, dev f1 score = 0.91838, Time 27m 28s (- 888m 14s)
Epoch 4/100: training loss = 0.38878, dev loss = 0.27521, dev f1 score = 0.92271, Time 36m 24s (- 873m 42s)
Update best f1: 0.91979 -> 0.92271, saving model to conv_sampler.pth
Epoch 5/100: training loss = 0.35764, dev loss = 0.24090, dev f1 score = 0.92563, Time 45m 40s (- 867m 40s)
Update best f1: 0.92271 -> 0.92563, saving model to conv_sampler.pth
Epoch 6/100: training loss = 0.34211, dev loss = 0.26837, dev f1 score = 0.92357, Time 54m 59s (- 861m 39s)
Epoch 7/100: training loss = 0.33116, dev loss = 0.24289, dev f1 score = 0.92395, Time 63m 53s (- 848m 56s)
Epoch 8/100: training loss = 0.30969, dev loss = 0.31531, dev f1 score = 0.92259, Time 72m 51s (- 837m 50s)
Epoch 9/100: training loss = 0.31660, dev loss = 0.26087, dev f1 score = 0.92650, Time 81m 45s (- 826m 42s)
Update best f1: 0.92563 -> 0.92650, saving model to conv_sampler.pth
Epoch 10/100: training loss = 0.29975, dev loss = 0.25221, dev f1 score = 0.92411, Time 91m 7s (- 820m 6s)
Epoch 11/100: training loss = 0.28956, dev loss = 0.27018, dev f1 score = 0.92631, Time 100m 0s (- 809m 9s)
Epoch 12/100: training loss = 0.28071, dev loss = 0.28404, dev f1 score = 0.92631, Time 108m 55s (- 798m 47s)
Epoch 13/100: training loss = 0.27910, dev loss = 0.24064, dev f1 score = 0.92617, Time 117m 52s (- 788m 48s)
Epoch 14/100: training loss = 0.28376, dev loss = 0.27030, dev f1 score = 0.92389, Time 126m 45s (- 778m 41s)
Epoch 15/100: training loss = 0.29047, dev loss = 0.24812, dev f1 score = 0.92469, Time 135m 42s (- 769m 3s)
Epoch 16/100: training loss = 0.26906, dev loss = 0.24959, dev f1 score = 0.92251, Time 144m 37s (- 759m 18s)
Epoch 17/100: training loss = 0.27666, dev loss = 0.27346, dev f1 score = 0.92645, Time 153m 33s (- 749m 42s)
Epoch 18/100: training loss = 0.25389, dev loss = 0.26877, dev f1 score = 0.92473, Time 162m 28s (- 740m 11s)
Epoch 19/100: training loss = 0.27143, dev loss = 0.31344, dev f1 score = 0.92506, Time 171m 24s (- 730m 43s)
Epoch 20/100: training loss = 0.25304, dev loss = 0.29421, dev f1 score = 0.92564, Time 180m 20s (- 721m 22s)
Epoch 21/100: training loss = 0.25967, dev loss = 0.26342, dev f1 score = 0.92731, Time 189m 14s (- 711m 56s)
Update best f1: 0.92650 -> 0.92731, saving model to conv_sampler.pth
Epoch 22/100: training loss = 0.25697, dev loss = 0.27430, dev f1 score = 0.92832, Time 198m 32s (- 703m 55s)
Update best f1: 0.92731 -> 0.92832, saving model to conv_sampler.pth
Epoch 23/100: training loss = 0.25615, dev loss = 0.29262, dev f1 score = 0.92427, Time 207m 50s (- 695m 47s)
Epoch 24/100: training loss = 0.25068, dev loss = 0.30481, dev f1 score = 0.92890, Time 216m 47s (- 686m 29s)
Update best f1: 0.92832 -> 0.92890, saving model to conv_sampler.pth
Epoch 25/100: training loss = 0.25663, dev loss = 0.27922, dev f1 score = 0.92829, Time 226m 3s (- 678m 9s)
Epoch 26/100: training loss = 0.25114, dev loss = 0.26255, dev f1 score = 0.92896, Time 234m 58s (- 668m 46s)
Update best f1: 0.92890 -> 0.92896, saving model to conv_sampler.pth
Epoch 27/100: training loss = 0.25089, dev loss = 0.29932, dev f1 score = 0.92878, Time 244m 14s (- 660m 22s)
Epoch 28/100: training loss = 0.25845, dev loss = 0.30655, dev f1 score = 0.92445, Time 253m 10s (- 651m 1s)
Epoch 29/100: training loss = 0.24360, dev loss = 0.28719, dev f1 score = 0.92486, Time 262m 6s (- 641m 42s)
Epoch 30/100: training loss = 0.24663, dev loss = 0.28837, dev f1 score = 0.92511, Time 271m 1s (- 632m 24s)
Epoch 31/100: training loss = 0.23609, dev loss = 0.32549, dev f1 score = 0.92547, Time 279m 57s (- 623m 7s)
Epoch 32/100: training loss = 0.25403, dev loss = 0.30729, dev f1 score = 0.92637, Time 288m 53s (- 613m 53s)
Epoch 33/100: training loss = 0.24641, dev loss = 0.32529, dev f1 score = 0.92591, Time 297m 48s (- 604m 39s)
Epoch 34/100: training loss = 0.24217, dev loss = 0.29858, dev f1 score = 0.92671, Time 306m 44s (- 595m 25s)
Epoch 35/100: training loss = 0.25176, dev loss = 0.30921, dev f1 score = 0.92718, Time 315m 37s (- 586m 10s)
Epoch 36/100: training loss = 0.24879, dev loss = 0.28902, dev f1 score = 0.93000, Time 324m 32s (- 576m 58s)
Update best f1: 0.92896 -> 0.93000, saving model to conv_sampler.pth
Epoch 37/100: training loss = 0.23885, dev loss = 0.30494, dev f1 score = 0.93186, Time 333m 52s (- 568m 30s)
Update best f1: 0.93000 -> 0.93186, saving model to conv_sampler.pth
Epoch 38/100: training loss = 0.23665, dev loss = 0.29854, dev f1 score = 0.93201, Time 343m 11s (- 559m 57s)
Update best f1: 0.93186 -> 0.93201, saving model to conv_sampler.pth
Epoch 39/100: training loss = 0.23803, dev loss = 0.30752, dev f1 score = 0.92625, Time 352m 29s (- 551m 19s)
Epoch 40/100: training loss = 0.23210, dev loss = 0.31573, dev f1 score = 0.92767, Time 361m 22s (- 542m 3s)
Epoch 41/100: training loss = 0.24628, dev loss = 0.32200, dev f1 score = 0.92801, Time 370m 18s (- 532m 52s)
Epoch 42/100: training loss = 0.24526, dev loss = 0.28658, dev f1 score = 0.93147, Time 379m 13s (- 523m 41s)
Epoch 43/100: training loss = 0.24259, dev loss = 0.31608, dev f1 score = 0.92720, Time 388m 8s (- 514m 30s)
Epoch 44/100: training loss = 0.24880, dev loss = 0.27817, dev f1 score = 0.92769, Time 397m 4s (- 505m 21s)
Epoch 45/100: training loss = 0.23251, dev loss = 0.33160, dev f1 score = 0.92829, Time 405m 55s (- 496m 7s)
Epoch 46/100: training loss = 0.24502, dev loss = 0.29479, dev f1 score = 0.93074, Time 414m 46s (- 486m 54s)
Epoch 47/100: training loss = 0.23639, dev loss = 0.28998, dev f1 score = 0.93070, Time 423m 37s (- 477m 42s)
Epoch 48/100: training loss = 0.23518, dev loss = 0.36013, dev f1 score = 0.92868, Time 432m 30s (- 468m 33s)
Epoch 49/100: training loss = 0.23117, dev loss = 0.31468, dev f1 score = 0.93061, Time 441m 24s (- 459m 25s)
Epoch 50/100: training loss = 0.23577, dev loss = 0.28196, dev f1 score = 0.92905, Time 450m 18s (- 450m 18s)
Epoch 51/100: training loss = 0.23659, dev loss = 0.33461, dev f1 score = 0.92575, Time 459m 12s (- 441m 12s)
Epoch 52/100: training loss = 0.23641, dev loss = 0.33452, dev f1 score = 0.92502, Time 468m 7s (- 432m 6s)
Epoch 53/100: training loss = 0.22866, dev loss = 0.33272, dev f1 score = 0.92892, Time 477m 2s (- 423m 1s)
Epoch 54/100: training loss = 0.23475, dev loss = 0.31618, dev f1 score = 0.92508, Time 485m 54s (- 413m 55s)
Epoch 55/100: training loss = 0.23538, dev loss = 0.30003, dev f1 score = 0.92789, Time 494m 49s (- 404m 51s)
Epoch 56/100: training loss = 0.23830, dev loss = 0.32340, dev f1 score = 0.92849, Time 503m 43s (- 395m 47s)
Epoch 57/100: training loss = 0.23021, dev loss = 0.36931, dev f1 score = 0.92252, Time 512m 38s (- 386m 43s)
Epoch 58/100: training loss = 0.23099, dev loss = 0.34217, dev f1 score = 0.92921, Time 521m 34s (- 377m 41s)
Epoch 59/100: training loss = 0.22863, dev loss = 0.37873, dev f1 score = 0.92634, Time 530m 24s (- 368m 35s)
Epoch 60/100: training loss = 0.23566, dev loss = 0.38180, dev f1 score = 0.92552, Time 539m 17s (- 359m 31s)
Epoch 61/100: training loss = 0.23007, dev loss = 0.36640, dev f1 score = 0.92857, Time 548m 11s (- 350m 29s)
Epoch 62/100: training loss = 0.23967, dev loss = 0.32623, dev f1 score = 0.92740, Time 557m 5s (- 341m 26s)
Epoch 63/100: training loss = 0.22861, dev loss = 0.35784, dev f1 score = 0.92711, Time 565m 59s (- 332m 24s)
Epoch 64/100: training loss = 0.23624, dev loss = 0.33241, dev f1 score = 0.92895, Time 574m 48s (- 323m 19s)
Epoch 65/100: training loss = 0.23097, dev loss = 0.32820, dev f1 score = 0.92778, Time 583m 38s (- 314m 16s)
Epoch 66/100: training loss = 0.23377, dev loss = 0.34596, dev f1 score = 0.92263, Time 592m 27s (- 305m 12s)
Epoch 67/100: training loss = 0.23431, dev loss = 0.30969, dev f1 score = 0.92825, Time 601m 17s (- 296m 9s)
Epoch 68/100: training loss = 0.23726, dev loss = 0.32433, dev f1 score = 0.92662, Time 610m 8s (- 287m 7s)
Epoch 69/100: training loss = 0.22891, dev loss = 0.36435, dev f1 score = 0.92708, Time 618m 56s (- 278m 4s)
Epoch 70/100: training loss = 0.22748, dev loss = 0.34718, dev f1 score = 0.92805, Time 627m 48s (- 269m 3s)
Epoch 71/100: training loss = 0.23159, dev loss = 0.32986, dev f1 score = 0.92720, Time 636m 39s (- 260m 2s)
Epoch 72/100: training loss = 0.22822, dev loss = 0.34794, dev f1 score = 0.92857, Time 645m 29s (- 251m 1s)
Epoch 73/100: training loss = 0.22476, dev loss = 0.34542, dev f1 score = 0.92510, Time 654m 18s (- 242m 0s)
Epoch 74/100: training loss = 0.23950, dev loss = 0.36382, dev f1 score = 0.92555, Time 663m 9s (- 233m 0s)
Epoch 75/100: training loss = 0.22360, dev loss = 0.35171, dev f1 score = 0.92338, Time 671m 59s (- 223m 59s)
Epoch 76/100: training loss = 0.23330, dev loss = 0.34890, dev f1 score = 0.92676, Time 680m 54s (- 215m 1s)
Epoch 77/100: training loss = 0.23649, dev loss = 0.32602, dev f1 score = 0.92482, Time 689m 51s (- 206m 3s)
Epoch 78/100: training loss = 0.23390, dev loss = 0.30130, dev f1 score = 0.92671, Time 698m 48s (- 197m 6s)
Epoch 79/100: training loss = 0.23714, dev loss = 0.32804, dev f1 score = 0.92692, Time 707m 25s (- 188m 2s)
Epoch 80/100: training loss = 0.24308, dev loss = 0.34917, dev f1 score = 0.92751, Time 716m 23s (- 179m 5s)
Epoch 81/100: training loss = 0.23300, dev loss = 0.32778, dev f1 score = 0.92498, Time 725m 19s (- 170m 8s)
Epoch 82/100: training loss = 0.22649, dev loss = 0.33970, dev f1 score = 0.93063, Time 734m 15s (- 161m 10s)
Epoch 83/100: training loss = 0.22390, dev loss = 0.35089, dev f1 score = 0.92808, Time 743m 13s (- 152m 13s)
Epoch 84/100: training loss = 0.22346, dev loss = 0.33601, dev f1 score = 0.92635, Time 752m 8s (- 143m 15s)
Epoch 85/100: training loss = 0.22967, dev loss = 0.35632, dev f1 score = 0.92426, Time 761m 4s (- 134m 18s)
Epoch 86/100: training loss = 0.23632, dev loss = 0.33529, dev f1 score = 0.92439, Time 770m 0s (- 125m 21s)
Epoch 87/100: training loss = 0.23503, dev loss = 0.33537, dev f1 score = 0.92783, Time 778m 56s (- 116m 23s)
Epoch 88/100: training loss = 0.23258, dev loss = 0.36048, dev f1 score = 0.92898, Time 787m 47s (- 107m 25s)
Epoch 89/100: training loss = 0.23018, dev loss = 0.32588, dev f1 score = 0.92803, Time 796m 39s (- 98m 27s)
Epoch 90/100: training loss = 0.23249, dev loss = 0.31507, dev f1 score = 0.92867, Time 805m 28s (- 89m 29s)
Epoch 91/100: training loss = 0.22981, dev loss = 0.33151, dev f1 score = 0.93112, Time 814m 24s (- 80m 32s)
Epoch 92/100: training loss = 0.24151, dev loss = 0.33175, dev f1 score = 0.92835, Time 823m 16s (- 71m 35s)
Epoch 93/100: training loss = 0.22278, dev loss = 0.32187, dev f1 score = 0.92954, Time 832m 14s (- 62m 38s)
Epoch 94/100: training loss = 0.23525, dev loss = 0.34182, dev f1 score = 0.92692, Time 841m 10s (- 53m 41s)
Epoch 95/100: training loss = 0.23721, dev loss = 0.32698, dev f1 score = 0.92550, Time 850m 7s (- 44m 44s)
Epoch 96/100: training loss = 0.23367, dev loss = 0.33629, dev f1 score = 0.92657, Time 859m 4s (- 35m 47s)
Epoch 97/100: training loss = 0.22898, dev loss = 0.34563, dev f1 score = 0.92663, Time 868m 1s (- 26m 50s)
Epoch 98/100: training loss = 0.23743, dev loss = 0.30481, dev f1 score = 0.92930, Time 876m 58s (- 17m 53s)
Epoch 99/100: training loss = 0.23072, dev loss = 0.32602, dev f1 score = 0.92917, Time 885m 54s (- 8m 56s)
Epoch 100/100: training loss = 0.22992, dev loss = 0.38388, dev f1 score = 0.92426, Time 894m 49s (- 0m 0s)
Best dev f1: 0.93201
